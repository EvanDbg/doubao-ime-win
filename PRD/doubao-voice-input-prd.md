# 豆包语音输入工具 - 产品需求文档 (PRD)

## 概述

基于豆包输入法的语音识别 API，开发一个轻量级、绿色便携的 Windows 语音输入工具。

## 核心功能

### 1. 语音识别
- 调用豆包 ASR API 进行实时语音识别
- 支持中英文混合识别
- 流式返回识别结果

### 2. 文本插入
- 将识别结果实时插入到当前焦点窗口
- 支持流式修正（删除旧文本，插入新文本）
- 兼容主流应用（记事本、Word、浏览器等）

### 3. 热键触发
- 组合键模式：Ctrl+Shift+V 开始/停止语音输入
- 双击模式：双击 Ctrl 键开始/停止

### 4. 系统托盘
- 托盘图标显示运行状态
- 右键菜单：开始/停止语音输入、设置、退出

### 5. 悬浮按钮（计划中）
- 可拖动的悬浮按钮
- 点击切换录音状态
- 录音时动画效果

## 技术架构

### 技术栈
- **语言**: Rust
- **异步运行时**: Tokio
- **音频采集**: cpal
- **音频编码**: Opus (audiopus_sys)
- **网络通信**: reqwest (HTTP), tokio-tungstenite (WebSocket)
- **协议**: Protobuf (prost)
- **UI**: tray-icon (系统托盘)

### 模块划分
1. **ASR 模块** - 设备注册、Token 获取、WebSocket 客户端
2. **音频模块** - 麦克风采集、Opus 编码
3. **业务逻辑** - 热键管理、语音控制、文本插入
4. **数据管理** - 配置文件、凭据存储
5. **UI 模块** - 系统托盘、设置界面

## 非功能需求

| 指标 | 目标 |
|------|------|
| 可执行文件大小 | < 10 MB |
| 内存占用 | < 100 MB |
| 启动速度 | < 2 秒 |
| 目标平台 | Windows 10/11 x64 |

## 分发方式

- **绿色便携**：单文件可执行，无需安装
- **配置文件**：config.toml 支持自定义设置
- **凭据存储**：本地 JSON 文件存储设备凭据

## 开发状态

- ✅ Phase 1: 项目初始化与基础框架
- ✅ Phase 2: 语音识别集成
- ⬜ Phase 3: 文本插入与 UI（部分完成）
- ✅ Phase 4: 配置与凭据管理
- ⬜ Phase 5: 打包与测试
